# 一、目标
前言
> 解耦思路可以理解为观察者模式的具体使用效果，在观察者模式中，当对象间存在一对多关系的时候，则使用观察者模式，它是一种定义对象间的一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并自动更新。

在Spring中有一个Event事件功能，它可以提供事件的定义、发布以及监听事件来完成一些自定义的动作。

本章节需要以观察者模式的方式，设计和实现Spring Event的容器事件和事件监听器功能，最终最终可以让我们在现有实现的Spring框架中可以定义、监听和发布自己的事件信息。

# 二、设计
在功能实现上我们需要定义出事件类、事件监听、事件发布，而这些类的功能需要结合到AbstractApplicationContext#refresh()方法中，以便于处理事件初始化和注册事件监听器的操作。

- 在整个功能实现过程中，需要在面向用户的应用上下文AbstractApplicationContext中添加相关事件内容，包括：初始化事件发布者、注册事件监听器、发布容器刷新完成事件。
- 使用观察者模式定义事件类、监听类、发布类，同时还需要完成一个广播器的功能，也就是使用isAssignableFrom进行判断

# 三、实现
- 整个类关系图围绕实现EventObject事件定义、发布和监听功能实现，以及把事件的相关内容使用AbstractApplicationContext#refresh进行注册和处理操作
- 在实现的过程中主要以扩展spring context包为主，事件的事件也是在这个包下面进行扩展的
- context的顶层接口ApplicationContext容器继承事件发布功能接口ApplicationEventPublisher，并在具体的实现类中提供事件监听功能
- ApplicationEventMulticaster接口是注册监听器和发布事件的广播器，提供添加、移除和发布事件的方法
- 最后是发布容器的关闭事件，这个仍然需要扩展到AbstractApplicationContext#close方法中，由注册到虚拟机的钩子方法实现
