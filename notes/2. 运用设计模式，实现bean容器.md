# 一、目标
在这一章节中，目标是对上一节实现的Bean容器进一步地完善。

这一次要将bean的创建交给容器，而不是我们在调用工厂注册的时候，传递一个实例化好的bean对象，另外还需要考虑单例对象，在对象的二次获取的时候是可以从内存中获取对象的。

此外还要完善基础容器框架的类结构体，以便将来可以扩容进去其他的功能。

# 二、设计
首先，在bean注册的时候只注册一个类信息，而不会把实例化的bean信息注册到Spring容器中。那么就需要修改BeanDefinition中的属性Object为Class。
接着，在获取bean对象的时候需要处理bean对象的实例化操作以及判断当前单例对象在容器中是否已经缓存起来了。

- 使用模板模式，统一定义：首先我们需要定义BeanFactory这样一个Bean工厂，提供Bean的获取方法`getBean(String name)`，之后这个Bean工厂接口由
抽象类AbstractBeanFactory实现。这样可以统一管理通用的核心方法的标准定义以及调用的逻辑，类的继承者只需要关心具体方法的逻辑实现即可。
  
- 继承抽象类，完成各司其职：在继承抽象类AbstractBeanFactory后的AbstractAutowireCapableBeanFactory就可以实现相应的抽象方法了。
因为AbstractAutowireCapableBeanFactory本身也是一个抽象类，因此它只会实现属于自己的抽象方法，其他抽象方法由继承这个类的类来实现。这就体现了类实现过程中的各司其职。
  
- 继承功能类，扩充功能：单例SingletonBeanRegistry接口负责定义方法，而DefaultSingletonBeanRegistry类对接口的方法进行实现。
而抽象类AbstractBeanFactory会继承这个类，从而扩充它本身的功能。
  

# 三、实现
本章节的Spring Bean容器类关系如下：

- 首先，BeanFactory接口定义了`getBean()`方法,AbstractBeanFactory抽象类实现了接口以及方法
- 接着，单例bean的实现：SingletonBeanRegistry接口定义方法，DefaultSingletonBeanRegistry实现了接口以及方法
- 扩充功能：AbstractBeanFactory继承了实现单例接口的类DefaultSingletonBeanRegistry，从而扩充了单例的功能
- AbstractBeanFactory抽象类中，又定义了两个抽象方法：getBeanDefinition(xxx)、createBean(xxx)
- 各司其职：AbstractAutowireCapableBeanFactory继承AbstractBeanFactory，实现createBean(xxx)方法，DefaultListableBeanFactory继承AbstractAutowireCapableBeanFactory，实现剩下的getBeanDefinition(xxx)抽象方法
- 最后，定义bean的注册接口BeanDefinitionRegistry，由DefaultListableBeanFactory类实现
